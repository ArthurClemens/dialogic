var ut=Object.defineProperty;var j=Object.getOwnPropertySymbols;var mt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;var H=(t,e,n)=>e in t?ut(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,x=(t,e)=>{for(var n in e||(e={}))mt.call(e,n)&&H(t,n,e[n]);if(j)for(var n of j(e))ft.call(e,n)&&H(t,n,e[n]);return t};import{m as a}from"./vendor.1cb0e66f.js";const pt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}};pt();var gt=Object.defineProperty,ht=Object.defineProperties,wt=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable,M=(t,e,n)=>e in t?gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vt=(t,e)=>{for(var n in e||(e={}))_t.call(e,n)&&M(t,n,e[n]);if(N)for(var n of N(e))yt.call(e,n)&&M(t,n,e[n]);return t},Ot=(t,e)=>ht(t,wt(e));function C(t){return O(function(){return t.map(function(e){return e()})},t)}function D(t){return t._state==="pending"||t._state==="active"||t._state==="changing"}var u=function(t){var e,n=[],o=[];function i(r){return arguments.length&&r!==u.SKIP&&(t=r,D(i)&&(i._changing(),i._state="active",n.slice().forEach(function(c,l){D(c)&&c(this[l](t))},o.slice()))),t}function s(){return(e=u()).map(function(r){return r===!0&&(i._parents.forEach(function(c){c._unregisterChild(i)}),i._state="ended",i._parents.length=n.length=o.length=0),r}),e}return i.constructor=u,i._state=arguments.length&&t!==u.SKIP?"active":"pending",i._parents=[],i._changing=function(){D(i)&&(i._state="changing"),n.forEach(function(r){r._changing()})},i._map=function(r,c){var l=c?u():u(r(t));return l._parents.push(i),n.push(l),o.push(r),l},i.map=function(r){return i._map(r,i._state!=="active")},i.toJSON=function(){return t!=null&&typeof t.toJSON=="function"?t.toJSON():t},i["fantasy-land/map"]=i.map,i["fantasy-land/ap"]=function(r){return O(function(c,l){return c()(l())},[r,i])},i._unregisterChild=function(r){var c=n.indexOf(r);c!==-1&&(n.splice(c,1),o.splice(c,1))},Object.defineProperty(i,"end",{get:function(){return e||s()}}),i};function O(t,e){var n=e.every(function(c){if(c.constructor!==u)throw new Error("Ensure that each item passed to stream.combine/stream.merge/lift is a stream.");return c._state==="active"}),o=n?u(t.apply(null,e.concat([e]))):u(),i=[],s=e.map(function(c){return c._map(function(l){return i.push(c),(n||e.every(function(p){return p._state!=="pending"}))&&(n=!0,o(t.apply(null,e.concat([i]))),i=[]),l},!0)}),r=o.end.map(function(c){c===!0&&(s.forEach(function(l){l.end(!0)}),r.end(!0))});return o}u.SKIP={},u.lift=function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return C(e).map(function(n){return t.apply(void 0,n)})},u.scan=function(t,e,n){var o=n.map(function(i){var s=t(e,i);return s!==u.SKIP&&(e=s),s});return o(e),o},u.merge=C,u.combine=O,u.scanMerge=function(t,e){var n=t.map(function(i){return i[0]}),o=O(function(){var i=arguments[arguments.length-1];return n.forEach(function(s,r){i.indexOf(s)>-1&&(e=t[r][1](e,s()))}),e},n);return o(e),o},u["fantasy-land/of"]=u;var R=!1;Object.defineProperty(u,"HALT",{get:function(){return R||console.log("HALT is deprecated and has been renamed to SKIP"),R=!0,u.SKIP}});var St=Object.defineProperty,bt=Object.defineProperties,It=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertySymbols,Pt=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable,q=(t,e,n)=>e in t?St(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,d=(t,e)=>{for(var n in e||(e={}))Pt.call(e,n)&&q(t,n,e[n]);if(V)for(var n of V(e))Tt.call(e,n)&&q(t,n,e[n]);return t},_=(t,e)=>bt(t,It(e));const Et=(t,e)=>e.find(n=>n.id===t),L=(t,e)=>{const n=Et(t,e);return n?e.indexOf(n):-1},Dt=(t,e)=>{const n=L(t,e);return n!==-1&&e.splice(n,1),e},F=(t,e)=>[e,t.id,t.spawn].filter(Boolean).join("-"),S={initialState:{store:{}},actions:t=>({add:(e,n)=>{t(o=>{const i=o.store[e]||[];return o.store[e]=[...i,n],n.timer&&n.timer.states.map(()=>S.actions(t).refresh()),o})},remove:(e,n)=>{t(o=>{const i=o.store[e]||[],s=Dt(n,i);return o.store[e]=s,o})},replace:(e,n,o)=>{t(i=>{const s=i.store[e]||[];if(s){const r=L(n,s);r!==-1&&(s[r]=o,i.store[e]=[...s])}return i})},removeAll:e=>{t(n=>(n.store[e]=[],n))},store:(e,n)=>{t(o=>(o.store[e]=[...n],o))},refresh:()=>{t(e=>d({},e))}}),selectors:t=>{const e={getStore:()=>t().store,find:(n,o)=>{const s=t().store[n]||[],r=F(o,n),c=s.find(l=>l.id===r);return c?{just:c}:{nothing:void 0}},getAll:(n,o)=>{const s=t().store[n]||[],r=o!==void 0?o.spawn:void 0,c=o!==void 0?o.id:void 0,l=r!==void 0?s.filter(g=>g.identityOptions.spawn===r):s;return c!==void 0?l.filter(g=>g.identityOptions.id===c):l},getCount:(n,o)=>e.getAll(n,o).length};return e}},B=u(),K=u.scan((t,e)=>e(t),d({},S.initialState),B),w=d({},S.actions(B)),h=d({},S.selectors(K)),b={callback:()=>{},isPaused:!1,onAbort:()=>{},onDone:()=>{},promise:void 0,remaining:void 0,startTime:void 0,timeoutFn:()=>{},timerId:void 0},kt=(t,e,n,o)=>{const i=()=>{e(),t.onDone(),o()};return d({timeoutFn:i,promise:new Promise(s=>{t.onDone=()=>s(),t.onAbort=()=>s()})},t.isPaused?{}:{startTime:new Date().getTime(),timerId:window.setTimeout(i,n),remaining:n})},I=t=>(window.clearTimeout(t.timerId),{timerId:b.timerId}),At=t=>d({},I(t)),$=t=>_(d({},I(t)),{isPaused:!0,remaining:W(t)}),jt=(t,e)=>{window.clearTimeout(t.timerId);const n=e?Math.max(t.remaining||0,e):t.remaining;return{startTime:new Date().getTime(),isPaused:!1,remaining:n,timerId:window.setTimeout(t.timeoutFn,n)}},W=t=>t.remaining===0||t.remaining===void 0?t.remaining:t.remaining-(new Date().getTime()-(t.startTime||0)),Ht=()=>{const t={initialState:b,actions:s=>({start:(r,c)=>{s(l=>d(d(d(d({},l),I(l)),kt(l,r,c,()=>t.actions(s).done())),l.isPaused&&$(l)))},stop:()=>{s(r=>d(d(d({},r),At(r)),b))},pause:()=>{s(r=>d(d({},r),!r.isPaused&&$(r)))},resume:r=>{s(c=>d(d({},c),c.isPaused&&jt(c,r)))},abort:()=>{s(r=>(r.onAbort(),d(d({},r),I(r))))},refresh:()=>{s(r=>d({},r))},done:()=>{s(()=>b)}}),selectors:s=>({isPaused:()=>s().isPaused,getRemaining:()=>{const r=s();return r.isPaused?r.remaining:W(r)},getResultPromise:()=>s().promise})},e=u(),n=u.scan((s,r)=>r(s),d({},t.initialState),e),o=d({},t.actions(e)),i=d({},t.selectors(n));return{states:n,actions:o,selectors:i}},J=(...t)=>e=>t.filter(Boolean).reduce((n,o)=>o(n),e),U=({domElement:t,prop:e})=>{const n=document.defaultView;if(n){const o=n.getComputedStyle(t);if(o)return o.getPropertyValue(e)}},k={SHOW:"show",HIDE:"hide"},xt=(t,e)=>t.classList.remove(...e.showStart,...e.showEnd,...e.hideStart,...e.hideEnd),G=(t,e,n)=>{const o=n[e];o&&Object.keys(o).forEach(i=>{const s=o[i];t.style[i]=s})},Nt=t=>{t.style.transitionDuration="0ms"},Mt=(t,e)=>(typeof e=="function"?e(t):e)||{},P=(t,e)=>t.split(/ /).map(n=>`${n}-${e}`),Q=(t,e,n,o)=>{if(e.styles){const i=Mt(t,e.styles);G(t,"default",i),o&&Nt(t),G(t,n,i)}if(e.className){const i={showStart:P(e.className,"show-start"),showEnd:P(e.className,"show-end"),hideStart:P(e.className,"hide-start"),hideEnd:P(e.className,"hide-end")};xt(t,i),i&&t.classList.add(...i[n])}t.scrollTop},X=t=>{const e=parseFloat(t)*(t.indexOf("ms")===-1?1e3:1);return Number.isNaN(e)?0:e},Ct=t=>{const e=U({domElement:t,prop:"transition-duration"}),n=e!==void 0?X(e):0,o=U({domElement:t,prop:"transition-delay"}),i=o!==void 0?X(o):0;return n+i},Rt={showStart:{nextStep:"showEnd"},showEnd:{nextStep:void 0},hideStart:{nextStep:"hideEnd"},hideEnd:{nextStep:void 0}},Vt=(t,e)=>{const{domElement:n}=t;if(!n)return Promise.resolve("no domElement");clearTimeout(t.__transitionTimeoutId__);let o=e===k.SHOW?"showStart":"hideStart";return new Promise(i=>{Q(n,t,o,o==="showStart"),setTimeout(()=>{const{nextStep:s}=Rt[o];if(s){o=s,Q(n,t,o);const r=Ct(n);t.__transitionTimeoutId__=window.setTimeout(i,r)}},0)})},T={uid:0},qt=()=>(T.uid===Number.MAX_VALUE?T.uid=0:T.uid+=1,T.uid);var z;(function(t){t[t.Default=0]="Default",t[t.Displaying=1]="Displaying",t[t.Hiding=2]="Hiding"})(z||(z={}));const Y=t=>e=>n=>h.find(t,tt(e,n)),Z=t=>e=>t.spawn!==void 0?e.filter(n=>n.identityOptions.spawn===t.spawn):e,Lt=t=>e=>t.id!==void 0?e.filter(n=>n.identityOptions.id===t.id):e,Ft=t=>{let e=0;return t.map(n=>({item:n,queueCount:n.dialogicOptions.queued?e++:0})).filter(({queueCount:n})=>n===0).map(({item:n})=>n)},Bt=(t,e,n)=>{const o=e[t]||[];return o.length===0?[]:J(Z(n),Ft)(o)},Kt=t=>{const e=d({},t);return delete e.dialogic,e},tt=(t,e={})=>({id:e.id||t.id,spawn:e.spawn||t.spawn}),et=(t,e={})=>{const n={id:e.dialogic?e.dialogic.id:void 0,spawn:e.dialogic?e.dialogic.spawn:void 0},o=tt(t||{},n),i=_(d(d({},t),e.dialogic),{__transitionTimeoutId__:0}),s=Kt(e);return{identityOptions:o,dialogicOptions:i,passThroughOptions:s}},$t=t=>e=>n=>{const{identityOptions:o,dialogicOptions:i,passThroughOptions:s}=et(e,n);return new Promise(r=>{const l={ns:t,identityOptions:o,dialogicOptions:i,callbacks:{willShow:f=>(i.willShow&&i.willShow(f),r(f)),willHide:f=>(i.willHide&&i.willHide(f),r(f)),didShow:f=>(i.didShow&&i.didShow(f),r(f)),didHide:f=>(i.didHide&&i.didHide(f),r(f))},passThroughOptions:s,id:F(o,t),timer:i.timeout?Ht():void 0,key:qt().toString(),transitionState:0},g=h.find(t,o).just;if(g&&i.toggle)return nt(t)(e)(n),r(g);if(g&&!i.queued){const f=_(d({},l),{key:g.key,transitionState:g.transitionState,dialogicOptions:g.dialogicOptions});w.replace(t,g.id,f)}else w.add(t,l);r(l)})},Wt=$t,nt=t=>e=>n=>{const{identityOptions:o,dialogicOptions:i,passThroughOptions:s}=et(e,n),c=h.find(t,o).just;if(c){const l=_(d({},c),{dialogicOptions:d(d({},c.dialogicOptions),i),passThroughOptions:_(d({},c.passThroughOptions),{passThroughOptions:s})});return w.replace(t,c.id,l),l.transitionState!==2?v(l):Promise.resolve(l)}return Promise.resolve({ns:t,id:o.id})},Jt=t=>e=>n=>{const o=y(t,n).filter(i=>!!i.timer);return o.forEach(i=>{i.timer&&i.timer.actions.pause()}),Promise.all(o)},Ut=t=>e=>n=>{const o=n||{},i={id:o.id,spawn:o.spawn},s=y(t,i).filter(r=>!!r.timer);return s.forEach(r=>{r.timer&&r.timer.actions.resume(o.minimumDuration)}),Promise.all(s)},it=(t,e,n)=>{var o,i;const s=Y(t)(e)(n);return(i=(o=s==null?void 0:s.just)==null?void 0:o.timer)==null?void 0:i.selectors},Gt=t=>e=>n=>{var o;return((o=it(t,e,n))==null?void 0:o.isPaused())||!1},Qt=t=>e=>n=>{var o;return((o=it(t,e,n))==null?void 0:o.getRemaining())||void 0},Xt=t=>e=>n=>!!y(t,n).length,y=(t,e)=>{const n=h.getAll(t);let o;return e?o=J(Z(e),Lt(e))(n):o=n,o},zt=t=>e=>n=>{const o=y(t,n),i=[];return o.forEach(s=>{s.timer&&s.timer.actions.abort(),i.push(s)}),n?i.forEach(s=>{w.remove(t,s.id)}):w.removeAll(t),Promise.resolve(i)},ot=(t,e)=>_(d({},t),{dialogicOptions:d(d({},t.dialogicOptions),e)}),Yt=t=>e=>n=>{const o=n||{},i={id:o.id,spawn:o.spawn},s=y(t,i),r=s.filter(p=>!o.queued&&!p.dialogicOptions.queued),c=s.filter(p=>o.queued||p.dialogicOptions.queued),l=[];if(r.forEach(p=>l.push(v(ot(p,o)))),c.length>0){const[p]=c;w.store(t,[p]),l.push(v(ot(p,o)))}return Promise.all(l)},Zt=t=>e=>h.getCount(t,e),st=(t,e)=>Vt(t.dialogicOptions,e),te=()=>t=>e=>n=>{const o=Y(t)(e)(n);if(o.just)return o.just&&o.just.timer?o.just.timer.selectors.getResultPromise():void 0},ee=async(t,e,n)=>(e.actions.start(()=>v(t),n),te()),rt=async t=>(t.callbacks.willShow&&t.callbacks.willShow(t),t.transitionState!==1&&(t.transitionState=1,await st(t,k.SHOW)),t.callbacks.didShow&&t.callbacks.didShow(t),t.dialogicOptions.timeout&&t.timer&&await ee(t,t.timer,t.dialogicOptions.timeout),Promise.resolve(t)),v=async t=>{t.transitionState=2,t.timer&&t.timer.actions.stop(),t.callbacks.willHide&&t.callbacks.willHide(t),await st(t,k.HIDE),t.callbacks.didHide&&t.callbacks.didHide(t);const e=d({},t);return w.remove(t.ns,t.id),Promise.resolve(e)},ne=(t,e)=>{e.dialogicOptions.domElement=t},at=({ns:t,queued:e,timeout:n})=>{const o=`default_${t}`,i=`default_${t}`,s=d(d({id:o,spawn:i},e&&{queued:e}),n!==void 0&&{timeout:n});return{ns:t,defaultId:o,defaultSpawn:i,defaultDialogicOptions:s,show:Wt(t)(s),hide:nt(t)(s),hideAll:Yt(t)(s),resetAll:zt(t)(s),pause:Jt(t)(s),resume:Ut(t)(s),exists:Xt(t)(s),getCount:Zt(t),isPaused:Gt(t)(s),getRemaining:Qt(t)(s)}},E=at({ns:"dialog"}),m=at({ns:"notification",queued:!0,timeout:3e3}),ct=t=>{let e,n,o=!1;const i={id:t.id,spawn:t.spawn},s=()=>{const r=t.instance.getRemaining(i);e!==r&&(e=r===void 0?r:t.roundToSeconds?Math.round(Math.max(r,0)/1e3):Math.max(r,0)),t.callback(e),t.instance.exists(i)?o||(n=window.requestAnimationFrame(s)):(window.cancelAnimationFrame(n),o=!0)};n=window.requestAnimationFrame(s)},ie=({attrs:t})=>{let e;const n=r=>{r({detail:{identityOptions:t.identityOptions,domElement:e}})},o=()=>{n(t.onMount)},i=()=>{n(t.onShow)},s=()=>{n(t.onHide)};return{oncreate:r=>{e=r.dom,o()},view:({attrs:r})=>{const c=r.dialogicOptions.component;if(!c)throw new Error("Component missing in dialogic options.");const l=r.passThroughOptions||{};return a("div",{className:r.dialogicOptions.className},a(c,Ot(vt({},l),{show:i,hide:s})))}}},A=t=>(e,n)=>{const o=h.find(t,e.detail.identityOptions);o.just&&ne(e.detail.domElement,o.just);const i=h.find(t,e.detail.identityOptions);i.just&&n(i.just)},oe=t=>e=>A(t)(e,rt),se=t=>e=>A(t)(e,rt),re=t=>e=>A(t)(e,v),ae={view:({attrs:t})=>{const e=oe(t.ns),n=se(t.ns),o=re(t.ns),i=t.identityOptions||{};return Bt(t.ns,h.getStore(),i).map(r=>a(ie,{key:r.key,identityOptions:r.identityOptions,dialogicOptions:r.dialogicOptions,passThroughOptions:r.passThroughOptions,onMount:e,onShow:n,onHide:o}))}},dt=t=>({oncreate:({attrs:e})=>{typeof e.onMount=="function"&&e.onMount()},view:({attrs:e})=>{const n={id:e.id||t.defaultId,spawn:e.spawn||t.defaultSpawn};return a(ae,{identityOptions:n,ns:t.ns})}}),ce=dt(E),de=dt(m);K.map(t=>{a.redraw()});const le={view:({attrs:t})=>a(".mdc-dialog__container",a(".mdc-dialog__surface",[a("h2.mdc-dialog__title",t.title),a(".mdc-dialog__content",t.body),a("footer.mdc-dialog__actions",[a("button.mdc-button.mdc-dialog__button",{onclick:()=>{E.hide(),t.onReject()}},a("span.mdc-button__label","Resume")),a("button.mdc-button.mdc-dialog__button",{onclick:()=>{E.hide(),t.onAccept()}},a("span.mdc-button__label","Hide all"))])]))},ue={view:({attrs:t})=>a(".mdc-dialog.mdc-dialog--open",[a(le,x({},t)),a(".mdc-dialog__scrim")])},me={view:({attrs:t})=>[a(".mdc-snackbar__label",t.remainingSeconds!==void 0?`Some async process message. Retrying in ${t.remainingSeconds} seconds.`:"Some async process message."),a(".mdc-snackbar__actions",a("button.mdc-button.mdc-snackbar__action",{onclick:()=>{m.pause(),E.show({dialogic:{component:ue,className:"dialog"},title:"About this dialog",body:"The notification is paused, so you can take your time to read this message.",onAccept:()=>{m.hide(),m.resume()},onReject:()=>{m.resume({minimumDuration:2e3})}})}},"Show options"))]},fe=()=>{let t;return ct({instance:m,roundToSeconds:!0,callback:e=>{e!==t&&(t=e,a.redraw())}}),{view:()=>a(".mdc-snackbar.mdc-snackbar--open",a(".mdc-snackbar__surface",a(me,{remainingSeconds:t})))}},pe=()=>{let t;return ct({instance:m,roundToSeconds:!1,callback:e=>{t=e,a.redraw()}}),{view:()=>a("span",{style:{minWidth:"3em",textAlign:"left"}},t===void 0?"0":t.toString())}};const ge={view:()=>[a(".page",[a("main",[a("h1","Dialogic for Mithril demo"),a(".message","Add one or more notifications, then click on the Show Options button in the message."),a(".ui.message",[a(".ui.button.primary",{onclick:()=>{m.show({dialogic:{component:fe,className:"notification",timeout:4e3}})}},"Add notification"),a(".ui.button",{onclick:()=>{m.pause()}},"Pause"),a(".ui.button",{onclick:()=>{m.resume()}},"Resume"),a(".ui.button",{onclick:()=>{m.hideAll()}},"Hide all"),a(".ui.button",{onclick:()=>{m.resetAll()}},"Reset all")]),a(".ui.message",[a(".ui.label",["Notifications",a(".detail",m.getCount())]),a(".ui.label",["Is paused",a(".detail",m.isPaused().toString())]),m.exists()&&a(".ui.label",["Remaining",a(".detail",a(pe))])])]),a("footer",[a("div",a.trust("Dialogic: manage dialogs and notifications. <a href='https://github.com/ArthurClemens/dialogic'>Main documentation on GitHub</a>"))])]),a(de),a(ce)]},lt=document.getElementById("app");lt&&a.mount(lt,ge);
