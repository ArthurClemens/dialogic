!function(i,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("dialogic"),require("mithril"),require("mithril-hooks")):"function"==typeof define&&define.amd?define(["exports","dialogic","mithril","mithril-hooks"],t):t((i="undefined"!=typeof globalThis?globalThis:i||self).dialogicMithril={},i.dialogic,i.m,i.mithrilHooks)}(this,(function(i,t,e,n){"use strict";function o(i){return i&&"object"==typeof i&&"default"in i?i:{default:i}}var s=o(e);const a=({attrs:i})=>{let t;const e=e=>{e({detail:{identityOptions:i.identityOptions,domElement:t}})},n=()=>{e(i.onShow)},o=()=>{e(i.onHide)};return{oncreate:n=>{t=n.dom,e(i.onMount)},view:({attrs:i})=>{const t=i.dialogicOptions.component;if(!t)throw new Error("Component missing in dialogic options.");const e=i.passThroughOptions||{};return s.default("div",{className:i.dialogicOptions.className},s.default(t,Object.assign(Object.assign({},e),{show:n,hide:o})))}}},d=i=>(e,n)=>{const o=t.selectors.find(i,e.detail.identityOptions);o.just&&t.setDomElement(e.detail.domElement,o.just);const s=t.selectors.find(i,e.detail.identityOptions);s.just&&n(s.just)},c={view:({attrs:i})=>{const e=(n=i.ns,i=>d(n)(i,t.showItem));var n;const o=(i=>e=>d(i)(e,t.showItem))(i.ns),c=(i=>e=>d(i)(e,t.hideItem))(i.ns),r=i.identityOptions||{};return t.filterCandidates(i.ns,t.selectors.getStore(),r).map(i=>s.default(a,{key:i.key,identityOptions:i.identityOptions,dialogicOptions:i.dialogicOptions,passThroughOptions:i.passThroughOptions,onMount:e,onShow:o,onHide:c}))}},r=i=>({oncreate:({attrs:i})=>{"function"==typeof i.onMount&&i.onMount()},view:({attrs:t})=>{const e={id:t.id||i.defaultId,spawn:t.spawn||i.defaultSpawn};return s.default(c,{identityOptions:e,ns:i.ns})}});let l=0;const u=({isIgnore:i,isShow:t,isHide:e,instance:o,deps:s=[],props:a={}})=>{const[d]=n.useState(l++),c=Object.assign(Object.assign({},a),a.dialogic?{dialogic:Object.assign(Object.assign({},a.dialogic),{id:a.dialogic.id||d})}:{dialogic:{id:d}}),r=()=>{o.show(c)},u=()=>{o.hide(c)};return n.useEffect(()=>{i||void 0!==t&&(t?r():u())},[...s,t]),n.useEffect(()=>{i||void 0!==e&&e&&u()},[...s,e]),n.useEffect(()=>{if(!i)return()=>{u()}},[]),{show:r,hide:u}},f=r(t.dialog),g=r(t.notification);t.states.map(i=>s.default.redraw()),Object.defineProperty(i,"Dialogic",{enumerable:!0,get:function(){return t.Dialogic}}),Object.defineProperty(i,"dialog",{enumerable:!0,get:function(){return t.dialog}}),Object.defineProperty(i,"notification",{enumerable:!0,get:function(){return t.notification}}),i.Dialog=f,i.Dialogical=r,i.Notification=g,i.useDialog=i=>u(Object.assign({instance:t.dialog},i)),i.useDialogic=u,i.useNotification=i=>u(Object.assign({instance:t.notification},i)),i.useRemaining=({instance:i,id:e,spawn:o,roundToSeconds:s})=>{const[a,d]=n.useState(void 0),c={id:e,spawn:o},r=!!i.exists(c);return n.useMemo(()=>{r&&t.remaining(Object.assign(Object.assign({},c),{instance:i,roundToSeconds:s,callback:i=>{d(i)}}))},[r]),[a]},Object.defineProperty(i,"__esModule",{value:!0})}));
//# sourceMappingURL=dialogic-mithril.js.map
