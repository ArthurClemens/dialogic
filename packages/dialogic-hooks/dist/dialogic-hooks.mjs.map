{"version":3,"file":"dialogic-hooks.mjs","sources":["../src/sharedUseDialogic.ts","../src/sharedUseRemaining.ts"],"sourcesContent":["import { Dialogic } from 'dialogic';\nimport { UseDialogicInstanceProps, SharedUseDialogicProps } from '..';\n\nlet useDialogicCounter = 0;\n\nexport const sharedUseDialogic = ({\n  useEffect,\n  useState,\n}: SharedUseDialogicProps) => <T>(allProps: UseDialogicInstanceProps<T>) => {\n  const {\n    isIgnore,\n    isShow,\n    isHide,\n    instance,\n    deps = [],\n    props = {} as T & Dialogic.Options<T>,\n  } = allProps;\n\n  // Create an id if not set.\n  // This is useful for pages with multiple dialogs, where we can't expect\n  // to have the user set an explicit id for each.\n  const [id] = useState(useDialogicCounter++);\n  const augProps = {\n    ...props,\n    ...(props.dialogic\n      ? {\n          dialogic: {\n            ...props.dialogic,\n            id: props.dialogic.id || id,\n          },\n        }\n      : {\n          dialogic: {\n            id,\n          },\n        }),\n  };\n\n  const showInstance = () => {\n    instance.show<T>(augProps);\n  };\n\n  const hideInstance = () => {\n    instance.hide<T>(augProps);\n  };\n\n  // maybe show\n  useEffect(() => {\n    if (isIgnore) return;\n    if (isShow !== undefined) {\n      if (isShow) {\n        showInstance();\n      } else {\n        hideInstance();\n      }\n    }\n  }, [...deps, isShow]);\n\n  // maybe hide\n  useEffect(() => {\n    if (isIgnore) return;\n    if (isHide !== undefined) {\n      if (isHide) {\n        hideInstance();\n      }\n    }\n  }, [...deps, isHide]);\n\n  // unmount\n  useEffect(() => {\n    if (isIgnore) return;\n    return () => {\n      hideInstance();\n    };\n  }, []);\n\n  return {\n    show: showInstance,\n    hide: hideInstance,\n  };\n};\n\n/**\n * `useDialogic` with `instance` set to `dialog`.\n */\nexport const sharedUseDialog = ({\n  useEffect,\n  useState,\n  dialog,\n}: SharedUseDialogicProps & { dialog: Dialogic.DialogicInstance }) => <T>(\n  props: UseDialogicInstanceProps<T>,\n) =>\n  sharedUseDialogic({ useEffect, useState })<T>({\n    ...props,\n    instance: dialog,\n  });\n\n/**\n * `useDialogic` with `instance` set to `notification`.\n */\nexport const sharedUseNotification = ({\n  useEffect,\n  useState,\n  notification,\n}: SharedUseDialogicProps & { notification: Dialogic.DialogicInstance }) => <T>(\n  props: UseDialogicInstanceProps<T>,\n) =>\n  sharedUseDialogic({ useEffect, useState })<T>({\n    ...props,\n    instance: notification,\n  });\n","import { remaining } from 'dialogic';\nimport { UseRemainingProps, SharedUseRemainingProps } from '..';\n\nexport const sharedUseRemaining = ({\n  useState,\n  useMemo,\n}: SharedUseRemainingProps) => (props: UseRemainingProps) => {\n  const [value, setValue] = useState<number | undefined>(undefined);\n  const identity = {\n    id: props.id,\n    spawn: props.spawn,\n  };\n  const exists = !!props.instance.exists(identity);\n  useMemo(() => {\n    if (exists) {\n      remaining({\n        ...identity,\n        instance: props.instance,\n        roundToSeconds: props.roundToSeconds,\n        callback: newValue => {\n          setValue(newValue);\n        },\n      });\n    }\n  }, [exists]);\n\n  return [value];\n};\n"],"names":[],"mappings":"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"}