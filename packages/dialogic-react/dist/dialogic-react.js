!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("dialogic"),require("react"),require("use-stream")):"function"==typeof define&&define.amd?define(["exports","dialogic","react","use-stream"],e):e((n=n||self).dialogicReact={},n.dialogic,n.React,n.useStream)}(this,(function(n,e,t,i){"use strict";var o="default"in t?t.default:t,r=function(n){return function(t,i){var o=e.selectors.find(n,t.detail.identityOptions);o.just&&e.setDomElement(t.detail.domElement,o.just);var r=e.selectors.find(n,t.detail.identityOptions);r.just&&i(r.just)}},a=function(){return(a=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};var u=function(n){var e=t.useRef(),i=n.dialogicOptions.className,r=n.dialogicOptions.component,u=t.useCallback((function(n){null!==n&&(e.current=n,s())}),[]),c=function(t){var i=e.current;void 0!==i&&t({detail:{identityOptions:n.identityOptions,domElement:i}})},s=function(){c(n.onMount)};return o.createElement("div",{ref:u,className:i},o.createElement(r,a({},n.passThroughOptions,{show:function(){c(n.onShow)},hide:function(){c(n.onHide)}})))},c=function(n){var t,i=(t=n.ns,function(n){return r(t)(n,e.showItem)}),a=function(n){return function(t){return r(n)(t,e.showItem)}}(n.ns),c=function(n){return function(t){return r(n)(t,e.hideItem)}}(n.ns),s=n.identityOptions||{},f=e.filterCandidates(n.ns,e.selectors.getStore(),s);return o.createElement(o.Fragment,null,f.map((function(n){return o.createElement(u,{key:n.key,identityOptions:n.identityOptions,dialogicOptions:n.dialogicOptions,passThroughOptions:n.passThroughOptions,onMount:i,onShow:a,onHide:c})})))},s=function(){i.useStream({model:function(){return{_:e.states}},defer:!0})},f=function(n){return function(e){s();var i={id:e.id||n.defaultId,spawn:e.spawn||n.defaultSpawn};return t.useEffect((function(){"function"==typeof e.onMount&&e.onMount()}),[]),o.createElement(c,{identityOptions:i,ns:n.ns})}},d=function(n){var e=n.pathname,i=n.locationPathname,o=void 0===i?window.location.pathname:i,r=n.instance,a=n.predicate,u=void 0===a?function(){return!0}:a,c=n.deps,s=void 0===c?[]:c,f=n.beforeHide,d=void 0===f?function(){return null}:f,l=n.props,p=t.useState(!1),m=p[0],g=p[1],h=function(n){!(void 0===n?{}:n).force&&m||(g(!0),d(),r.hide(l))};t.useEffect((function(){return o===e?u()&&(g(!1),g(!1),r.show(l)):h(),function(){h({force:!0})}}),function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var i=Array(n),o=0;for(e=0;e<t;e++)for(var r=arguments[e],a=0,u=r.length;a<u;a++,o++)i[o]=r[a];return i}(s,[o]))},l=function(n){return d(n),null},p=f(e.dialog),m=f(e.notification);Object.defineProperty(n,"dialog",{enumerable:!0,get:function(){return e.dialog}}),Object.defineProperty(n,"notification",{enumerable:!0,get:function(){return e.notification}}),n.Dialog=p,n.Dialogical=f,n.MakeAppear=l,n.MakeAppearDialog=function(n){return o.createElement(l,a({},n,{instance:e.dialog}))},n.MakeAppearNotification=function(n){return o.createElement(l,a({},n,{instance:e.notification}))},n.Notification=m,n.useDialogicState=s,n.useMakeAppear=d,n.useMakeAppearDialog=function(n){return d(a(a({},n),{instance:e.dialog}))},n.useMakeAppearNotification=function(n){return d(a(a({},n),{instance:e.notification}))},n.useRemaining=function(n){var i=t.useState(void 0),o=i[0],r=i[1],a=t.useRef(!1);return t.useEffect((function(){return e.remaining({instance:n.instance,roundToSeconds:n.roundToSeconds,callback:function(n){a.current||r(n)}}),function(){a.current=!0}}),[]),[o]},Object.defineProperty(n,"__esModule",{value:!0})}));
