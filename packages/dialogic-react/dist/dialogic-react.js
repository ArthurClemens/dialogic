!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("dialogic"),require("react"),require("use-stream")):"function"==typeof define&&define.amd?define(["exports","dialogic","react","use-stream"],t):t((e=e||self).dialogicReact={},e.dialogic,e.React,e.useStream)}(this,(function(e,t,i,n){"use strict";var o="default"in i?i.default:i;const s=e=>(i,n)=>{const o=t.selectors.find(e,i.detail.identityOptions);o.just&&t.setDomElement(i.detail.domElement,o.just);const s=t.selectors.find(e,i.detail.identityOptions);s.just&&n(s.just)},a=e=>{const t=i.useRef(),n=e.dialogicOptions.className,s=e.dialogicOptions.component;if(!s)throw"Component missing in dialogic options.";const a=i.useCallback(e=>{null!==e&&(t.current=e,d())},[]),c=i=>{const n=t.current;void 0!==n&&i({detail:{identityOptions:e.identityOptions,domElement:n}})},d=()=>{c(e.onMount)};return o.createElement("div",{ref:a,className:n},o.createElement(s,Object.assign({},e.passThroughOptions,{show:()=>{c(e.onShow)},hide:()=>{c(e.onHide)}})))},c=e=>{const i=(n=e.ns,e=>s(n)(e,t.showItem));var n;const c=(e=>i=>s(e)(i,t.showItem))(e.ns),d=(e=>i=>s(e)(i,t.hideItem))(e.ns),l=e.identityOptions||{},r=t.filterCandidates(e.ns,t.selectors.getStore(),l);return o.createElement(o.Fragment,null,r.map(e=>o.createElement(a,{key:e.key,identityOptions:e.identityOptions,dialogicOptions:e.dialogicOptions,passThroughOptions:e.passThroughOptions,onMount:i,onShow:c,onHide:d})))},d=()=>{n.useStream({model:()=>({_:t.states}),defer:!0})},l=e=>t=>{d();const n={id:t.id||e.defaultId,spawn:t.spawn||e.defaultSpawn};return i.useEffect(()=>{"function"==typeof t.onMount&&t.onMount()},[]),o.createElement(c,{identityOptions:n,ns:e.ns})};let r=0;const u=e=>{const{isShow:t,isHide:n,instance:o,deps:s=[],beforeShow:a=(()=>null),beforeHide:c=(()=>null),props:d={}}=e,[l]=i.useState(r++),u={...d,...d.dialogic?{dialogic:{...d.dialogic,id:d.dialogic.id||l}}:{dialogic:{id:l}}},f=()=>{a(),o.show(u)},g=()=>{c(),o.hide(u)};return i.useEffect(()=>{void 0!==t&&(t?f():g())},[...s,t]),i.useEffect(()=>{void 0!==n&&n&&g()},[...s,n]),i.useEffect(()=>()=>{g()},[]),{show:f,hide:g}},f=e=>(u(e),null),g=l(t.dialog),p=l(t.notification);Object.defineProperty(e,"dialog",{enumerable:!0,get:function(){return t.dialog}}),Object.defineProperty(e,"notification",{enumerable:!0,get:function(){return t.notification}}),e.Dialog=g,e.Dialogical=l,e.Notification=p,e.UseDialog=e=>o.createElement(f,Object.assign({},e,{instance:t.dialog})),e.UseDialogic=f,e.UseNotification=e=>o.createElement(f,Object.assign({},e,{instance:t.notification})),e.useDialog=e=>u({...e,instance:t.dialog}),e.useDialogic=u,e.useDialogicState=d,e.useNotification=e=>u({...e,instance:t.notification}),e.useRemaining=e=>{const[n,o]=i.useState(void 0),s=i.useRef(!1);return i.useEffect(()=>(t.remaining({instance:e.instance,roundToSeconds:e.roundToSeconds,callback:e=>{s.current||o(e)}}),()=>{s.current=!0}),[]),[n]},Object.defineProperty(e,"__esModule",{value:!0})}));
