!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("dialogic"),require("react"),require("use-stream")):"function"==typeof define&&define.amd?define(["exports","dialogic","react","use-stream"],t):t((n=n||self).dialogicReact={},n.dialogic,n.React,n.useStream)}(this,(function(n,t,e,i){"use strict";var o="default"in e?e.default:e,r=function(n){return function(e,i){var o=t.selectors.find(n,e.detail.identityOptions);o.just&&t.setDomElement(e.detail.domElement,o.just);var r=t.selectors.find(n,e.detail.identityOptions);r.just&&i(r.just)}},u=function(){return(u=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function c(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var i=Array(n),o=0;for(t=0;t<e;t++)for(var r=arguments[t],u=0,c=r.length;u<c;u++,o++)i[o]=r[u];return i}var a=function(n){var t=e.useRef(),i=n.dialogicOptions.className,r=n.dialogicOptions.component;if(!r)throw"Component missing in dialogic options.";var c=e.useCallback((function(n){null!==n&&(t.current=n,s())}),[]),a=function(e){var i=t.current;void 0!==i&&e({detail:{identityOptions:n.identityOptions,domElement:i}})},s=function(){a(n.onMount)};return o.createElement("div",{ref:c,className:i},o.createElement(r,u({},n.passThroughOptions,{show:function(){a(n.onShow)},hide:function(){a(n.onHide)}})))},s=function(n){var e,i=(e=n.ns,function(n){return r(e)(n,t.showItem)}),u=function(n){return function(e){return r(n)(e,t.showItem)}}(n.ns),c=function(n){return function(e){return r(n)(e,t.hideItem)}}(n.ns),s=n.identityOptions||{},f=t.filterCandidates(n.ns,t.selectors.getStore(),s);return o.createElement(o.Fragment,null,f.map((function(n){return o.createElement(a,{key:n.key,identityOptions:n.identityOptions,dialogicOptions:n.dialogicOptions,passThroughOptions:n.passThroughOptions,onMount:i,onShow:u,onHide:c})})))},f=function(){i.useStream({model:function(){return{_:t.states}},defer:!0})},d=function(n){return function(t){f();var i={id:t.id||n.defaultId,spawn:t.spawn||n.defaultSpawn};return e.useEffect((function(){"function"==typeof t.onMount&&t.onMount()}),[]),o.createElement(s,{identityOptions:i,ns:n.ns})}},l=0,p=function(n){var t=n.isShow,i=n.isHide,o=n.instance,r=n.deps,a=void 0===r?[]:r,s=n.beforeShow,f=void 0===s?function(){return null}:s,d=n.beforeHide,p=void 0===d?function(){return null}:d,g=n.props,m=void 0===g?{}:g,h=e.useState(l++)[0],v=u(u({},m),m.dialogic?{dialogic:u(u({},m.dialogic),{id:m.dialogic.id||h})}:{dialogic:{id:h}}),y=function(){f(),o.show(v)},O=function(){p(),o.hide(v)};return e.useEffect((function(){void 0!==t&&(t?y():O())}),c(a,[t])),e.useEffect((function(){void 0!==i&&i&&O()}),c(a,[i])),e.useEffect((function(){return function(){O()}}),[]),{show:y,hide:O}},g=function(n){return p(n),null},m=d(t.dialog),h=d(t.notification);Object.defineProperty(n,"dialog",{enumerable:!0,get:function(){return t.dialog}}),Object.defineProperty(n,"notification",{enumerable:!0,get:function(){return t.notification}}),n.Dialog=m,n.Dialogical=d,n.Notification=h,n.UseDialog=function(n){return o.createElement(g,u({},n,{instance:t.dialog}))},n.UseDialogic=g,n.UseNotification=function(n){return o.createElement(g,u({},n,{instance:t.notification}))},n.useDialog=function(n){return p(u(u({},n),{instance:t.dialog}))},n.useDialogic=p,n.useDialogicState=f,n.useNotification=function(n){return p(u(u({},n),{instance:t.notification}))},n.useRemaining=function(n){var i=e.useState(void 0),o=i[0],r=i[1],u=e.useRef(!1);return e.useEffect((function(){return t.remaining({instance:n.instance,roundToSeconds:n.roundToSeconds,callback:function(n){u.current||r(n)}}),function(){u.current=!0}}),[]),[o]},Object.defineProperty(n,"__esModule",{value:!0})}));
