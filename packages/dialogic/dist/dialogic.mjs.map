{"version":3,"file":"dialogic.mjs","sources":["../src/utils.ts","../src/transition.ts","../src/state/store.ts","../src/state/timer.ts","../src/dialogic.ts","../src/dialogical.ts","../src/dialog.ts","../src/notification.ts","../src/remaining.ts"],"sourcesContent":["export const isClient = typeof document !== 'undefined';\nexport const isServer = !isClient;\n\ntype Fn = (args: any) => any;\n\nexport const pipe = (...fns: Fn[]) => (x: any) =>\n  fns.filter(Boolean).reduce((y, f) => f(y), x);\n\nexport const getStyleValue = ({\n  domElement,\n  prop,\n}: {\n  domElement: HTMLElement;\n  prop: string;\n}) => {\n  const defaultView = document.defaultView;\n  if (defaultView) {\n    const style = defaultView.getComputedStyle(domElement);\n    if (style) {\n      return style.getPropertyValue(prop);\n    }\n  }\n};\n","import { getStyleValue } from './utils';\nimport { Dialogic } from '../index';\n\nexport const MODE = {\n  SHOW: 'show',\n  HIDE: 'hide',\n};\n\ntype TransitionProps = {\n  domElement?: HTMLElement;\n  className?: string;\n  styles?: Dialogic.TransitionStyles | Dialogic.TransitionStylesFn;\n  __transitionTimeoutId__?: number;\n};\n\ntype TransitionClassNames = {\n  [key: string]: string[];\n  showStart: string[];\n  showEnd: string[];\n  hideStart: string[];\n  hideEnd: string[];\n};\n\ntype TransitionStep = 'showStart' | 'showEnd' | 'hideStart' | 'hideEnd';\ntype TransitionStyleState = 'default' | TransitionStep;\n\nconst removeTransitionClassNames = (\n  domElement: HTMLElement,\n  transitionClassNames: TransitionClassNames,\n) =>\n  domElement.classList.remove(\n    ...transitionClassNames.showStart,\n    ...transitionClassNames.showEnd,\n    ...transitionClassNames.hideStart,\n    ...transitionClassNames.hideEnd,\n  );\n\nconst applyTransitionStyles = (\n  domElement: HTMLElement,\n  step: TransitionStyleState,\n  styles: Dialogic.TransitionStyles,\n) => {\n  const transitionStyle = (styles[step] as CSSStyleDeclaration) || {};\n  Object.keys(transitionStyle).forEach((key: any) => {\n    const value = transitionStyle[key].toString();\n    domElement.style[key] = value;\n    // if (domElement.style[key] !== value) {\n    // \tconsole.warn(`Invalid style: ${key}: ${value} (${domElement.style[key]})`);\n    // }\n  });\n};\n\nconst applyNoDurationTransitionStyle = (domElement: HTMLElement) =>\n  (domElement.style.transitionDuration = '0ms');\n\nconst getTransitionStyles = (\n  domElement: HTMLElement,\n  styles: Dialogic.TransitionStyles | Dialogic.TransitionStylesFn,\n) => (typeof styles === 'function' ? styles(domElement) : styles) || {};\n\nconst createClassList = (className: string, step: string) =>\n  className.split(/ /).map((n: string) => `${n}-${step}`);\n\nconst applyStylesForState = (\n  domElement: HTMLElement,\n  props: TransitionProps,\n  step: TransitionStep,\n  isEnterStep?: boolean,\n) => {\n  if (props.styles) {\n    const styles = getTransitionStyles(domElement, props.styles);\n    applyTransitionStyles(domElement, 'default', styles);\n    isEnterStep && applyNoDurationTransitionStyle(domElement);\n    applyTransitionStyles(domElement, step, styles);\n  }\n\n  if (props.className) {\n    const transitionClassNames: TransitionClassNames = {\n      showStart: createClassList(props.className, 'show-start'),\n      showEnd: createClassList(props.className, 'show-end'),\n      hideStart: createClassList(props.className, 'hide-start'),\n      hideEnd: createClassList(props.className, 'hide-end'),\n    };\n    removeTransitionClassNames(domElement, transitionClassNames);\n    transitionClassNames &&\n      domElement.classList.add(...transitionClassNames[step]);\n  }\n\n  // reflow\n  domElement.scrollTop;\n};\n\nconst getDuration = (domElement: HTMLElement) => {\n  const durationStyleValue = getStyleValue({\n    domElement,\n    prop: 'transition-duration',\n  });\n  const durationValue =\n    durationStyleValue !== undefined\n      ? styleDurationToMs(durationStyleValue)\n      : 0;\n  const delayStyleValue = getStyleValue({\n    domElement,\n    prop: 'transition-delay',\n  });\n  const delayValue =\n    delayStyleValue !== undefined ? styleDurationToMs(delayStyleValue) : 0;\n  return durationValue + delayValue;\n};\n\ntype Step = {\n  nextStep?: TransitionStep;\n};\n\ntype Steps = {\n  showStart: Step;\n  showEnd: Step;\n  hideStart: Step;\n  hideEnd: Step;\n};\n\nconst steps: Steps = {\n  showStart: {\n    nextStep: 'showEnd',\n  },\n  showEnd: {\n    nextStep: undefined,\n  },\n  hideStart: {\n    nextStep: 'hideEnd',\n  },\n  hideEnd: {\n    nextStep: undefined,\n  },\n};\n\nexport const transition = (props: TransitionProps, mode?: string) => {\n  const domElement = props.domElement;\n  if (!domElement) {\n    return Promise.resolve('no domElement');\n  }\n  clearTimeout(props.__transitionTimeoutId__);\n\n  let currentStep: TransitionStep =\n    mode === MODE.SHOW ? 'showStart' : 'hideStart';\n\n  return new Promise(resolve => {\n    applyStylesForState(\n      domElement,\n      props,\n      currentStep,\n      currentStep === 'showStart',\n    );\n\n    setTimeout(() => {\n      const nextStep = steps[currentStep].nextStep;\n      if (nextStep) {\n        currentStep = nextStep;\n        applyStylesForState(domElement, props, currentStep);\n        // addEventListener sometimes hangs this function because it never finishes\n        // Using setTimeout instead of addEventListener gives more consistent results\n        const duration = getDuration(domElement);\n        props.__transitionTimeoutId__ = window.setTimeout(resolve, duration);\n      }\n    }, 0);\n  });\n};\n\nconst styleDurationToMs = (durationStr: string) => {\n  const parsed =\n    parseFloat(durationStr) * (durationStr.indexOf('ms') === -1 ? 1000 : 1);\n  return isNaN(parsed) ? 0 : parsed;\n};\n","import Stream from 'mithril/stream';\nimport { Dialogic } from '../..';\n\ntype PatchFn = (state: Dialogic.State) => Dialogic.State;\n\nconst findItem = (id: string, items: any[]) => {\n  return items.find(item => item.id === id);\n};\n\nconst itemIndex = (id: string, items: any[]) => {\n  const item = findItem(id, items);\n  return items.indexOf(item);\n};\n\nconst removeItem = (id: string, items: any[]) => {\n  const index = itemIndex(id, items);\n  if (index !== -1) {\n    items.splice(index, 1);\n  }\n  return items;\n};\n\nexport const createId = (\n  identityOptions: Dialogic.IdentityOptions,\n  ns: string,\n) => [ns, identityOptions.id, identityOptions.spawn].filter(Boolean).join('-');\n\nconst store = {\n  initialState: {\n    store: {},\n  },\n\n  actions: (update: Stream<PatchFn>) => {\n    return {\n      /**\n       * Add an item to the end of the list.\n       */\n      add: (ns: string, item: Dialogic.Item<unknown>) => {\n        update((state: Dialogic.State) => {\n          const items = state.store[ns] || [];\n          state.store[ns] = [...items, item as Dialogic.Item<unknown>];\n          if (item.timer) {\n            // When the timer state updates, refresh the store so that UI can pick up the change\n            item.timer.states.map(() => store.actions(update).refresh());\n          }\n          return state;\n        });\n      },\n\n      /**\n       * Removes the first item with a match on `id`.\n       */\n      remove: (ns: string, id: string) => {\n        update((state: Dialogic.State) => {\n          const items = state.store[ns] || [];\n          const remaining = removeItem(id, items);\n          state.store[ns] = remaining;\n          return state;\n        });\n      },\n\n      /**\n       * Replaces the first item with a match on `id` with a newItem.\n       */\n      replace: (ns: string, id: string, newItem: Dialogic.Item<unknown>) => {\n        update((state: Dialogic.State) => {\n          const items = state.store[ns] || [];\n          if (items) {\n            const index = itemIndex(id, items);\n            if (index !== -1) {\n              items[index] = newItem;\n              state.store[ns] = [...items];\n            }\n          }\n          return state;\n        });\n      },\n\n      /**\n       * Removes all items within a namespace.\n       */\n      removeAll: (ns: string) => {\n        update((state: Dialogic.State) => {\n          state.store[ns] = [];\n          return state;\n        });\n      },\n\n      /**\n       * Replaces all items within a namespace.\n       */\n      store: (ns: string, newItems: Dialogic.Item<unknown>[]) => {\n        update((state: Dialogic.State) => {\n          state.store[ns] = [...newItems];\n          return state;\n        });\n      },\n\n      refresh: () => {\n        update((state: Dialogic.State) => {\n          return {\n            ...state,\n          };\n        });\n      },\n    };\n  },\n\n  selectors: (states: Stream<Dialogic.State>) => {\n    const fns = {\n      getStore: () => {\n        const state = states();\n        return state.store;\n      },\n\n      find: <T>(ns: string, identityOptions: Dialogic.IdentityOptions) => {\n        const state = states();\n        const items = state.store[ns] || [];\n        const id = createId(identityOptions, ns);\n        const item = items.find(\n          (item: Dialogic.Item<unknown>) => item.id === id,\n        ) as Dialogic.Item<T>;\n        return item ? { just: item } : { nothing: undefined };\n      },\n\n      getAll: (ns: string, identityOptions?: Dialogic.IdentityOptions) => {\n        const state = states();\n        const items = state.store[ns] || [];\n        const spawn =\n          identityOptions !== undefined ? identityOptions.spawn : undefined;\n        const id =\n          identityOptions !== undefined ? identityOptions.id : undefined;\n        const itemsBySpawn =\n          spawn !== undefined\n            ? items.filter(item => item.identityOptions.spawn === spawn)\n            : items;\n        const itemsById =\n          id !== undefined\n            ? itemsBySpawn.filter(item => item.identityOptions.id === id)\n            : itemsBySpawn;\n        return itemsById;\n      },\n\n      getCount: (ns: string, identityOptions?: Dialogic.IdentityOptions) =>\n        fns.getAll(ns, identityOptions).length,\n    };\n\n    return fns;\n  },\n};\n\nconst update: Stream<PatchFn> = Stream<PatchFn>();\n\nexport const states: Dialogic.States = Stream.scan(\n  (state: Dialogic.State, patch: PatchFn) => patch(state),\n  {\n    ...store.initialState,\n  },\n  update,\n);\n\nexport const actions = {\n  ...store.actions(update),\n};\n\nexport const selectors: Dialogic.StateSelectors = {\n  ...store.selectors(states),\n};\n\n// states.map(state =>\n//   console.log(JSON.stringify(state, null, 2))\n// );\n","import Stream from 'mithril/stream';\nimport { Dialogic } from '../..';\n\ntype PatchFn = (state: Dialogic.TimerState) => Dialogic.TimerState;\n\nconst initialState = {\n  callback: () => {},\n  isPaused: false,\n  onAbort: () => {},\n  onDone: () => {},\n  promise: undefined,\n  remaining: undefined,\n  startTime: undefined,\n  timeoutFn: () => {},\n  timerId: undefined,\n};\n\nconst appendStartTimer = (\n  state: Dialogic.TimerState,\n  callback: Dialogic.TimerCallback,\n  duration: number,\n  updateState: () => any,\n) => {\n  const timeoutFn = () => {\n    callback();\n    state.onDone();\n    updateState();\n  };\n  return {\n    timeoutFn,\n    promise: new Promise<void>(resolve => {\n      state.onDone = () => resolve();\n      state.onAbort = () => resolve();\n    }),\n    ...(state.isPaused\n      ? {}\n      : {\n          startTime: new Date().getTime(),\n          timerId: window.setTimeout(timeoutFn, duration),\n          remaining: duration,\n        }),\n  };\n};\n\nconst appendStopTimeout = (state: Dialogic.TimerState) => {\n  window.clearTimeout(state.timerId);\n  return {\n    timerId: initialState.timerId,\n  };\n};\n\nconst appendStopTimer = (state: Dialogic.TimerState) => {\n  return {\n    ...appendStopTimeout(state),\n  };\n};\n\nconst appendPauseTimer = (state: Dialogic.TimerState) => {\n  return {\n    ...appendStopTimeout(state),\n    isPaused: true,\n    remaining: getRemaining(state),\n  };\n};\n\nconst appendResumeTimer = (\n  state: Dialogic.TimerState,\n  minimumDuration?: number,\n) => {\n  window.clearTimeout(state.timerId);\n  const remaining = minimumDuration\n    ? Math.max(state.remaining || 0, minimumDuration)\n    : state.remaining;\n  return {\n    startTime: new Date().getTime(),\n    isPaused: false,\n    remaining,\n    timerId: window.setTimeout(state.timeoutFn, remaining),\n  };\n};\n\nconst getRemaining = (state: Dialogic.TimerState) =>\n  state.remaining === 0 || state.remaining === undefined\n    ? state.remaining\n    : state.remaining - (new Date().getTime() - (state.startTime || 0));\n\nexport const Timer = () => {\n  const timer = {\n    initialState,\n    actions: (update: Stream<PatchFn>) => {\n      return {\n        start: (callback: Dialogic.TimerCallback, duration: number) => {\n          update((state: Dialogic.TimerState) => {\n            return {\n              ...state,\n              ...appendStopTimeout(state),\n              ...appendStartTimer(state, callback, duration, () =>\n                timer.actions(update).done(),\n              ),\n              ...(state.isPaused && appendPauseTimer(state)),\n            };\n          });\n        },\n\n        stop: () => {\n          update((state: Dialogic.TimerState) => {\n            return {\n              ...state,\n              ...appendStopTimer(state),\n              ...initialState,\n            };\n          });\n        },\n\n        pause: () => {\n          update((state: Dialogic.TimerState) => {\n            return {\n              ...state,\n              ...(!state.isPaused && appendPauseTimer(state)),\n            };\n          });\n        },\n\n        resume: (minimumDuration?: number) => {\n          update((state: Dialogic.TimerState) => {\n            return {\n              ...state,\n              ...(state.isPaused && appendResumeTimer(state, minimumDuration)),\n            };\n          });\n        },\n\n        abort: () => {\n          update((state: Dialogic.TimerState) => {\n            state.onAbort();\n            return {\n              ...state,\n              ...appendStopTimeout(state),\n            };\n          });\n        },\n\n        done: () => {\n          update((state: Dialogic.TimerState) => {\n            return initialState;\n          });\n        },\n\n        refresh: () => {\n          update((state: Dialogic.TimerState) => {\n            return {\n              ...state,\n            };\n          });\n        },\n      };\n    },\n\n    selectors: (states: Stream<Dialogic.TimerState>) => {\n      return {\n        isPaused: () => {\n          const state = states();\n          return state.isPaused;\n        },\n\n        getRemaining: () => {\n          const state = states();\n          return state.isPaused ? state.remaining : getRemaining(state);\n        },\n\n        getResultPromise: () => {\n          const state = states();\n          return state.promise;\n        },\n      };\n    },\n  };\n\n  const update: Stream<PatchFn> = Stream<PatchFn>();\n\n  const states: Dialogic.TimerStates = Stream.scan(\n    (state: Dialogic.TimerState, patch: PatchFn) => patch(state),\n    {\n      ...timer.initialState,\n    },\n    update,\n  );\n\n  const actions = {\n    ...timer.actions(update),\n  };\n\n  const selectors: Dialogic.TimerStateSelectors = {\n    ...timer.selectors(states),\n  };\n\n  // states.map(state =>\n  //   console.log(JSON.stringify(state, null, 2))\n  // );\n\n  return {\n    states,\n    actions,\n    selectors,\n  };\n};\n","import { transition, MODE } from './transition';\nimport { actions, selectors, createId } from './state/store';\nimport { Timer } from './state/timer';\nimport { Dialogic } from '../index';\nimport { pipe } from './utils';\n\nexport { states, actions, selectors } from './state/store';\n\nlet uid = 0;\nconst getUid = () => (uid === Number.MAX_VALUE ? 0 : uid++);\n\nconst transitionStates = {\n  default: 0,\n  displaying: 1,\n  hiding: 2,\n};\n\nconst getMaybeItem = <T>(ns: string) => (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n) => (identityOptions?: Dialogic.IdentityOptions) =>\n  selectors.find<T>(\n    ns,\n    getMergedIdentityOptions(defaultDialogicOptions, identityOptions),\n  );\n\nconst filterBySpawn = <T>(identityOptions: Dialogic.IdentityOptions) => (\n  items: Dialogic.Item<T>[],\n) =>\n  identityOptions.spawn !== undefined\n    ? items.filter(item => item.identityOptions.spawn === identityOptions.spawn)\n    : items;\n\nconst filterById = <T>(identityOptions: Dialogic.IdentityOptions) => (\n  items: Dialogic.Item<T>[],\n) =>\n  identityOptions.id !== undefined\n    ? items.filter(item => item.identityOptions.id === identityOptions.id)\n    : items;\n\n/**\n * Gets a list of all non-queued items.\n * From the queued items only the first item is listed.\n * */\nconst filterFirstInQueue = <T>(nsItems: Dialogic.Item<T>[]) => {\n  let queuedCount = 0;\n  return nsItems\n    .map(item => ({\n      item,\n      queueCount: item.dialogicOptions.queued ? queuedCount++ : 0,\n    }))\n    .filter(({ queueCount }) => queueCount === 0)\n    .map(({ item }) => item);\n};\n\nexport const filterCandidates = (\n  ns: string,\n  items: Dialogic.NamespaceStore,\n  identityOptions: Dialogic.IdentityOptions,\n) => {\n  const nsItems = items[ns] || [];\n  if (nsItems.length == 0) {\n    return [];\n  }\n  return pipe(filterBySpawn(identityOptions), filterFirstInQueue)(nsItems);\n};\n\ntype TGetPassThroughOptions = <T>(options: Dialogic.Options<T>) => T;\n\nconst getPassThroughOptions: TGetPassThroughOptions = options => {\n  const copy = {\n    ...options,\n  };\n  delete copy.dialogic;\n  return copy;\n};\n\nconst getMergedIdentityOptions = (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n  identityOptions: Dialogic.IdentityOptions = {},\n) =>\n  ({\n    id: identityOptions.id || defaultDialogicOptions.id,\n    spawn: identityOptions.spawn || defaultDialogicOptions.spawn,\n  } as Dialogic.IdentityOptions);\n\nconst handleOptions = <T>(\n  defaultDialogicOptions?: Dialogic.DefaultDialogicOptions,\n  options: Dialogic.Options<T> = {} as T,\n) => {\n  const identityOptions = {\n    id: options.dialogic ? options.dialogic.id : undefined,\n    spawn: options.dialogic ? options.dialogic.spawn : undefined,\n  };\n  const mergedIdentityOptions = getMergedIdentityOptions(\n    defaultDialogicOptions || ({} as Dialogic.DefaultDialogicOptions),\n    identityOptions,\n  );\n\n  const dialogicOptions: Dialogic.DialogicOptions<T> = {\n    ...defaultDialogicOptions,\n    ...options.dialogic,\n    __transitionTimeoutId__: 0,\n  };\n\n  const passThroughOptions = getPassThroughOptions(options);\n\n  return {\n    identityOptions: mergedIdentityOptions,\n    dialogicOptions,\n    passThroughOptions,\n  };\n};\n\nconst createInstance = <T>(ns: string) => (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n) => (options: Dialogic.Options<T> = {} as T) => {\n  const {\n    identityOptions,\n    dialogicOptions,\n    passThroughOptions,\n  } = handleOptions(defaultDialogicOptions, options);\n\n  return new Promise(resolve => {\n    const callbacks: Dialogic.Callbacks<T> = {\n      willShow: (item: Dialogic.Item<T>) => {\n        if (dialogicOptions.willShow) {\n          dialogicOptions.willShow(item);\n        }\n        return resolve(item);\n      },\n      willHide: (item: Dialogic.Item<T>) => {\n        if (dialogicOptions.willHide) {\n          dialogicOptions.willHide(item);\n        }\n        return resolve(item);\n      },\n      didShow: (item: Dialogic.Item<T>) => {\n        if (dialogicOptions.didShow) {\n          dialogicOptions.didShow(item);\n        }\n        return resolve(item);\n      },\n      didHide: (item: Dialogic.Item<T>) => {\n        if (dialogicOptions.didHide) {\n          dialogicOptions.didHide(item);\n        }\n        return resolve(item);\n      },\n    };\n\n    const item: Dialogic.Item<T> = {\n      ns,\n      identityOptions,\n      dialogicOptions,\n      callbacks,\n      passThroughOptions,\n      id: createId(identityOptions, ns),\n      timer: dialogicOptions.timeout ? Timer() : undefined, // when timeout is undefined or 0\n      key: getUid().toString(), // Uniquely identify each item for keyed display\n      transitionState: transitionStates.default,\n    };\n\n    const maybeExistingItem: Dialogic.MaybeItem<T> = selectors.find<T>(\n      ns,\n      identityOptions,\n    );\n\n    if (maybeExistingItem.just && dialogicOptions.toggle) {\n      const hideResult = hide<T>(ns)(defaultDialogicOptions)(options);\n      return resolve(hideResult);\n    }\n\n    if (maybeExistingItem.just && !dialogicOptions.queued) {\n      const existingItem = maybeExistingItem.just;\n      // Preserve dialogicOptions\n      const dialogicOptions = existingItem.dialogicOptions;\n      const replacingItem = {\n        ...item,\n        key: existingItem.key,\n        transitionState: existingItem.transitionState,\n        dialogicOptions,\n      };\n      actions.replace(\n        ns,\n        existingItem.id,\n        replacingItem as Dialogic.Item<unknown>,\n      );\n    } else {\n      actions.add(ns, item as Dialogic.Item<unknown>);\n      // This will instantiate and draw the instance\n      // The instance will call `showDialog` in `onMount`\n    }\n\n    resolve(item);\n  });\n};\n\nexport const show = createInstance;\n\nexport const hide = <T>(ns: string) => (\n  defaultDialogicOptions?: Dialogic.DefaultDialogicOptions,\n) => (options?: Dialogic.Options<T>) => {\n  const {\n    identityOptions,\n    dialogicOptions,\n    passThroughOptions,\n  } = handleOptions(defaultDialogicOptions, options);\n  const maybeExistingItem: Dialogic.MaybeItem<T> = selectors.find<T>(\n    ns,\n    identityOptions,\n  );\n  if (maybeExistingItem.just) {\n    const existingItem = maybeExistingItem.just;\n    const item = {\n      ...existingItem,\n      dialogicOptions: {\n        ...existingItem.dialogicOptions,\n        ...dialogicOptions,\n      },\n      passThroughOptions: {\n        ...existingItem.passThroughOptions,\n        passThroughOptions,\n      },\n    };\n    actions.replace(ns, existingItem.id, item as Dialogic.Item<unknown>);\n    if (item.transitionState !== transitionStates.hiding) {\n      return hideItem(item);\n    } else {\n      return Promise.resolve(item);\n    }\n  }\n  return Promise.resolve();\n};\n\nexport const pause = (ns: string) => (\n  defaultDialogicOptions?: Dialogic.DefaultDialogicOptions,\n) => (identityOptions?: Dialogic.IdentityOptions) => {\n  const items = getValidItems(ns, identityOptions).filter(item => !!item.timer);\n  items.forEach(\n    (item: Dialogic.Item<unknown>) => item.timer && item.timer.actions.pause(),\n  );\n  return Promise.all(items);\n};\n\nexport const resume = (ns: string) => (\n  defaultDialogicOptions?: Dialogic.DefaultDialogicOptions,\n) => (commandOptions?: Dialogic.CommandOptions) => {\n  const options = commandOptions || {};\n  const identityOptions = {\n    id: options.id,\n    spawn: options.spawn,\n  };\n  const items = getValidItems(ns, identityOptions).filter(item => !!item.timer);\n  items.forEach(\n    (item: Dialogic.Item<unknown>) =>\n      item.timer && item.timer.actions.resume(options.minimumDuration),\n  );\n  return Promise.all(items);\n};\n\nexport const getTimerProperty = (\n  timerProp: 'isPaused' | 'getRemaining' | 'getResultPromise',\n  defaultValue: false | 0 | undefined,\n) => (ns: string) => (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n) => (identityOptions?: Dialogic.IdentityOptions) => {\n  const maybeItem: Dialogic.MaybeItem<unknown> = getMaybeItem<unknown>(ns)(\n    defaultDialogicOptions,\n  )(identityOptions);\n  if (maybeItem.just) {\n    if (maybeItem.just && maybeItem.just.timer) {\n      return maybeItem.just.timer.selectors[timerProp]();\n    } else {\n      return defaultValue;\n    }\n  } else {\n    return defaultValue;\n  }\n};\n\nexport const isPaused = getTimerProperty('isPaused', false);\nexport const getRemaining = getTimerProperty('getRemaining', undefined);\n\nexport const exists = (ns: string) => (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n) => (identityOptions: Dialogic.IdentityOptions) =>\n  !!getValidItems(ns, identityOptions).length;\n\ntype getValidItemsFn = <T>(\n  ns: string,\n  identityOptions?: Dialogic.IdentityOptions,\n) => Dialogic.Item<T>[];\n\nconst getValidItems: getValidItemsFn = (ns, identityOptions) => {\n  const allItems = selectors.getAll(ns);\n  let validItems;\n  if (identityOptions) {\n    validItems = pipe(\n      filterBySpawn(identityOptions),\n      filterById(identityOptions),\n    )(allItems);\n  } else {\n    validItems = allItems;\n  }\n  return validItems;\n};\n\nexport const resetAll = (ns: string) => (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n) => (identityOptions?: Dialogic.IdentityOptions) => {\n  const validItems = getValidItems(ns, identityOptions);\n  const items: Dialogic.Item<unknown>[] = [];\n\n  validItems.forEach((item: Dialogic.Item<unknown>) => {\n    item.timer && item.timer.actions.abort();\n    items.push(item);\n  });\n\n  if (identityOptions) {\n    items.forEach((item: Dialogic.Item<unknown>) => {\n      actions.remove(ns, item.id);\n    });\n  } else {\n    actions.removeAll(ns);\n  }\n\n  return Promise.resolve(items);\n};\n\nconst getOverridingTransitionOptions = <T>(\n  item: Dialogic.Item<T>,\n  dialogicOptions: Dialogic.DialogicOptions<T>,\n) => {\n  return {\n    ...item,\n    dialogicOptions: {\n      ...item.dialogicOptions,\n      ...dialogicOptions,\n    },\n  };\n};\n\n/**\n * Triggers a `hideItem` for each item in the store.\n * Queued items: will trigger `hideItem` only for the first item, then reset the store.\n * Optional `dialogicOptions` may be passed with specific transition options. This comes in handy when all items should hide in the same way.\n */\nexport const hideAll = (ns: string) => (\n  defaultDialogicOptions: Dialogic.DefaultDialogicOptions,\n) => (dialogicOptions?: Dialogic.DialogicOptions<unknown>) => {\n  const options = dialogicOptions || {};\n  const identityOptions: Dialogic.IdentityOptions = {\n    id: options.id,\n    spawn: options.spawn,\n  };\n  const validItems = getValidItems(ns, identityOptions);\n  const regularItems = validItems.filter(\n    (item: Dialogic.Item<unknown>) =>\n      !options.queued && !item.dialogicOptions.queued,\n  );\n  const queuedItems = validItems.filter(\n    (item: Dialogic.Item<unknown>) =>\n      options.queued || item.dialogicOptions.queued,\n  );\n\n  const items = [];\n\n  regularItems.forEach((item: Dialogic.Item<unknown>) =>\n    items.push(hideItem(getOverridingTransitionOptions(item, options))),\n  );\n\n  if (queuedItems.length > 0) {\n    const [current] = queuedItems;\n    // Make sure that any remaining items don't suddenly appear\n    actions.store(ns, [current]);\n    // Transition the current item\n    items.push(hideItem(getOverridingTransitionOptions(current, options)));\n  }\n\n  return Promise.all(items);\n};\n\nexport const getCount = (ns: string) => (\n  identityOptions?: Dialogic.IdentityOptions,\n) => selectors.getCount(ns, identityOptions);\n\nconst transitionItem = <T>(item: Dialogic.Item<T>, mode: string) =>\n  transition(item.dialogicOptions, mode);\n\nconst deferredHideItem = async function <T>(\n  item: Dialogic.Item<T>,\n  timer: Dialogic.Timer,\n  timeout: number,\n) {\n  timer.actions.start(() => hideItem(item), timeout);\n  return getTimerProperty('getResultPromise', undefined);\n};\n\nexport const showItem: Dialogic.InitiateItemTransitionFn = async function (\n  item,\n) {\n  if (item.callbacks.willShow) {\n    item.callbacks.willShow(item);\n  }\n  if (item.transitionState !== transitionStates.displaying) {\n    item.transitionState = transitionStates.displaying;\n    await transitionItem(item, MODE.SHOW);\n  }\n  if (item.callbacks.didShow) {\n    item.callbacks.didShow(item);\n  }\n  if (item.dialogicOptions.timeout && item.timer) {\n    await deferredHideItem(item, item.timer, item.dialogicOptions.timeout);\n  }\n  return Promise.resolve(item);\n};\n\nexport const hideItem: Dialogic.InitiateItemTransitionFn = async function (\n  item,\n) {\n  item.transitionState = transitionStates.hiding;\n  // Stop any running timer\n  if (item.timer) {\n    item.timer.actions.stop();\n  }\n  if (item.callbacks.willHide) {\n    item.callbacks.willHide(item);\n  }\n  await transitionItem(item, MODE.HIDE);\n  if (item.callbacks.didHide) {\n    item.callbacks.didHide(item);\n  }\n  const copy = {\n    ...item,\n  };\n  actions.remove(item.ns, item.id);\n  return Promise.resolve(copy);\n};\n\nexport const setDomElement = <T>(\n  domElement: HTMLElement,\n  item: Dialogic.Item<T>,\n) => {\n  item.dialogicOptions.domElement = domElement;\n};\n","import {\n  show,\n  hide,\n  hideAll,\n  resetAll,\n  getCount,\n  pause,\n  resume,\n  isPaused,\n  getRemaining,\n  exists,\n} from './dialogic';\nimport { Dialogic } from '../index';\n\nexport const dialogical = ({\n  ns,\n  queued,\n  timeout,\n}: {\n  ns: string;\n  queued?: boolean;\n  timeout?: number;\n}) => {\n  const defaultId = `default_${ns}`;\n  const defaultSpawn = `default_${ns}`;\n  const defaultDialogicOptions: Dialogic.DefaultDialogicOptions = {\n    id: defaultId,\n    spawn: defaultSpawn,\n    ...(queued && { queued }),\n    ...(timeout !== undefined && { timeout }),\n  };\n\n  return {\n    // Identification\n    ns,\n    defaultId,\n    defaultSpawn,\n    // Configuration\n    defaultDialogicOptions,\n    // Commands\n    show: show(ns)(defaultDialogicOptions),\n    hide: hide(ns)(defaultDialogicOptions),\n    hideAll: hideAll(ns)(defaultDialogicOptions),\n    resetAll: resetAll(ns)(defaultDialogicOptions),\n    // Timer commands\n    pause: pause(ns)(defaultDialogicOptions),\n    resume: resume(ns)(defaultDialogicOptions),\n    // State\n    exists: exists(ns)(defaultDialogicOptions),\n    getCount: getCount(ns),\n    // Timer state\n    isPaused: isPaused(ns)(defaultDialogicOptions),\n    getRemaining: getRemaining(ns)(defaultDialogicOptions),\n  };\n};\n","import { dialogical } from './dialogical';\n\nexport const dialog = dialogical({ ns: 'dialog' });\n","import { dialogical } from './dialogical';\n\nexport const notification = dialogical({\n  ns: 'notification',\n  queued: true,\n  timeout: 3000,\n});\n","/**\n * Utility script that uses an animation frame to pass the current remaining value\n * (which is utilized when setting `timeout`).\n */\n\nimport { Dialogic } from '../index';\n\nexport const remaining = (props: Dialogic.RemainingProps) => {\n  let displayValue: number | undefined = undefined;\n  let reqId: number;\n  let isCanceled: boolean = false;\n  const identity = {\n    id: props.id,\n    spawn: props.spawn,\n  };\n\n  const update = () => {\n    const remaining = props.instance.getRemaining(identity);\n    if (displayValue !== remaining) {\n      displayValue =\n        remaining === undefined\n          ? remaining\n          : props.roundToSeconds\n          ? Math.round(Math.max(remaining, 0) / 1000)\n          : Math.max(remaining, 0);\n    }\n    props.callback(displayValue);\n    if (!props.instance.exists(identity)) {\n      window.cancelAnimationFrame(reqId);\n      isCanceled = true;\n    } else if (!isCanceled) {\n      reqId = window.requestAnimationFrame(update);\n    }\n  };\n  reqId = window.requestAnimationFrame(update);\n};\n"],"names":["getRemaining"],"mappings":"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"}